<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `mylib` crate."><meta name="keywords" content="rust, rustlang, rust-lang, mylib"><title>mylib - Rust</title><link rel="stylesheet" type="text/css" href="../normalize.css"><link rel="stylesheet" type="text/css" href="../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../dark.css"><link rel="stylesheet" type="text/css" href="../light.css" id="themeStyle"><script src="../storage.js"></script><noscript><link rel="stylesheet" href="../noscript.css"></noscript><link rel="shortcut icon" href="../favicon.ico"><style type="text/css">#crate-search{background-image:url("../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../mylib/index.html'><div class='logo-container'><img src='../rust-logo.png' alt='logo'></div></a><p class='location'>Crate mylib</p><div class="sidebar-elems"><a id='all-types' href='all.html'><p>See all mylib's items</p></a><div class="block items"><ul><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#functions">Functions</a></li></ul></div><p class='location'></p><script>window.sidebarCurrent = {name: 'mylib', ty: 'mod', relpath: '../'};</script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../settings.html"><img src="../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../src/mylib/lib.rs.html#1-80' title='goto source code'>[src]</a></span><span class='in-band'>Crate <a class="mod" href=''>mylib</a></span></h1><div class='docblock'><p>Sensor app that reads sensor data from a temperature sensor and sends the sensor data to a CoAP server or Collector Node.
Note that we are using a patched version of apps/my_sensor_app/src/vsscanf.c that
fixes ESP8266 response parsing bugs.  The patched file must be present in that location.
This is the Rust version of <code>https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/rust/apps/my_sensor_app/OLDsrc/main.c</code></p>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table><tr class='module-item'><td><a class="mod" href="base/index.html" title='mylib::base mod'>base</a></td><td class='docblock-short'><p>Common declarations for the application.  Includes custom sensor declarations.</p>
</td></tr><tr class='module-item'><td><a class="mod" href="listen_sensor/index.html" title='mylib::listen_sensor mod'>listen_sensor</a></td><td class='docblock-short'><p>Poll the temperature sensor every 10 seconds.  We support 2 types of temperature sensors:
(1)  BME280 Temperature Sensor, connected to Blue Pill on port SPI1.
This sensor is selected if BME280_OFB is defined in syscfg.yml.
(2)  Blue Pill internal temperature sensor, connected to port ADC1 on channel 16
This sensor is selected if TEMP_STM32 is defined in syscfg.yml.
If this is the Collector Node, send the sensor data to the CoAP Server after polling.
This is the Rust version of <code>https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/rust/apps/my_sensor_app/OLDsrc/listen_sensor.c</code></p>
</td></tr><tr class='module-item'><td><a class="mod" href="mynewt/index.html" title='mylib::mynewt mod'>mynewt</a></td><td class='docblock-short'><p>Mynewt API for Rust. Contains Rust bindings for Mynewt API for C, generated by <code>bindgen</code>.
Also includes safe versions of Mynewt APIs created specially for Rust.</p>
</td></tr><tr class='module-item'><td><a class="mod" href="send_coap/index.html" title='mylib::send_coap mod'>send_coap</a></td><td class='docblock-short'><p>Send sensor data to a CoAP Server or a Collector Node.  The CoAP payload will be encoded as JSON
for CoAP Server and CBOR for Collector Node.  The sensor data will be transmitted to 
CoAP Server over WiFi via the ESP8266 transceiver, and to Collector Node via nRF24L01 transceiver.
This enables transmission of Sensor Data to a local Sensor Network (via nRF24L01)
and to the internet (via ESP8266).  For sending to Collector Node we use raw temperature (integer) 
instead of computed temperature (floating-point) to make the encoding simpler and faster.
Note that we are using a patched version of apps/my_sensor_app/src/vsscanf.c that
fixes ESP8266 response parsing bugs.  The patched file must be present in that location.
This is the Rust version of <code>https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/rust/apps/my_sensor_app/OLDsrc/send_coap.c</code></p>
</td></tr></table><h2 id='macros' class='section-header'><a href="#macros">Macros</a></h2>
<table><tr class='module-item'><td><a class="macro" href="macro.coap.html" title='mylib::coap macro'>coap</a></td><td class='docblock-short'><p>Macro to compose a CoAP payloads with JSON or CBOR encoding.
Adapted from the <code>json!()</code> macro: https://docs.serde.rs/src/serde_json/macros.rs.html</p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.coap_array.html" title='mylib::coap_array macro'>coap_array</a></td><td class='docblock-short'><p>Compose an array under &quot;object&quot;, named as &quot;key&quot;.  Add &quot;children&quot; as array elements.</p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.coap_item.html" title='mylib::coap_item macro'>coap_item</a></td><td class='docblock-short'><p>Append an array item under the array named <code>array0</code>.  Add <code>children0</code> as the items (key and value).
<code>{ &lt;array0&gt;: [ ..., { &lt;children0&gt; } ] }</code></p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.coap_item_int.html" title='mylib::coap_item_int macro'>coap_item_int</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.coap_item_int_val.html" title='mylib::coap_item_int_val macro'>coap_item_int_val</a></td><td class='docblock-short'><p>Create a new Item object in the parent array and set the Sensor Value's key/value (integer).</p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.coap_item_str.html" title='mylib::coap_item_str macro'>coap_item_str</a></td><td class='docblock-short'><p>Append a (<code>key</code> + <code>val</code> string value) item to the array named <code>parent</code>:
<code>{ &lt;parent&gt;: [ ..., {&quot;key&quot;: &lt;key&gt;, &quot;value&quot;: &lt;val&gt;} ] }</code></p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.coap_root.html" title='mylib::coap_root macro'>coap_root</a></td><td class='docblock-short'><p>Compose the payload root.</p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.coap_set_int_val.html" title='mylib::coap_set_int_val macro'>coap_set_int_val</a></td><td class='docblock-short'><p>Given an object parent and an integer Sensor Value val, set the val's key/value in the object.</p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.d.html" title='mylib::d macro'>d</a></td><td class='docblock-short'><p>Macro to dump all tokens received as a literal string, e.g.
<code>d!(a b c)</code> returns <code>&quot;a b c&quot;</code></p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.fill_zero.html" title='mylib::fill_zero macro'>fill_zero</a></td><td class='docblock-short'><p>Return a const struct that has all fields set to 0. Used for initialising static mutable structs like <code>os_task</code>.
<code>fill_zero!(os_task)</code> expands to</p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.json_rep_close_array.html" title='mylib::json_rep_close_array macro'>json_rep_close_array</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.json_rep_object_array_end_item.html" title='mylib::json_rep_object_array_end_item macro'>json_rep_object_array_end_item</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.json_rep_object_array_start_item.html" title='mylib::json_rep_object_array_start_item macro'>json_rep_object_array_start_item</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.json_rep_set_array.html" title='mylib::json_rep_set_array macro'>json_rep_set_array</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.json_rep_set_int.html" title='mylib::json_rep_set_int macro'>json_rep_set_int</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.json_rep_set_text_string.html" title='mylib::json_rep_set_text_string macro'>json_rep_set_text_string</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.json_value_int.html" title='mylib::json_value_int macro'>json_value_int</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.json_value_string.html" title='mylib::json_value_string macro'>json_value_string</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.nx.html" title='mylib::nx macro'>nx</a></td><td class='docblock-short'><p>Macro to display the token being parsed and the remaining tokens</p>
</td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_close_array.html" title='mylib::oc_rep_close_array macro'>oc_rep_close_array</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_end_array.html" title='mylib::oc_rep_end_array macro'>oc_rep_end_array</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_end_object.html" title='mylib::oc_rep_end_object macro'>oc_rep_end_object</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_end_root_object.html" title='mylib::oc_rep_end_root_object macro'>oc_rep_end_root_object</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_object_array_end_item.html" title='mylib::oc_rep_object_array_end_item macro'>oc_rep_object_array_end_item</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_object_array_start_item.html" title='mylib::oc_rep_object_array_start_item macro'>oc_rep_object_array_start_item</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_set_array.html" title='mylib::oc_rep_set_array macro'>oc_rep_set_array</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_set_int.html" title='mylib::oc_rep_set_int macro'>oc_rep_set_int</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_set_text_string.html" title='mylib::oc_rep_set_text_string macro'>oc_rep_set_text_string</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_start_array.html" title='mylib::oc_rep_start_array macro'>oc_rep_start_array</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_start_object.html" title='mylib::oc_rep_start_object macro'>oc_rep_start_object</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.oc_rep_start_root_object.html" title='mylib::oc_rep_start_root_object macro'>oc_rep_start_root_object</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.parse.html" title='mylib::parse macro'>parse</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.parse_vector.html" title='mylib::parse_vector macro'>parse_vector</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.test_ident.html" title='mylib::test_ident macro'>test_ident</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.test_internal_rules.html" title='mylib::test_internal_rules macro'>test_internal_rules</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.test_internal_rules2.html" title='mylib::test_internal_rules2 macro'>test_internal_rules2</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.test_literal.html" title='mylib::test_literal macro'>test_literal</a></td><td class='docblock-short'></td></tr><tr class='module-item'><td><a class="macro" href="macro.unexpected_token.html" title='mylib::unexpected_token macro'>unexpected_token</a></td><td class='docblock-short'></td></tr></table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table><tr class='module-item'><td><a class="fn" href="fn.main.html" title='mylib::main fn'>main</a></td><td class='docblock-short'><p>main() will be called at Mynewt startup. It replaces the C version of the main() function.</p>
</td></tr><tr class='module-item'><td><a class="fn" href="fn.panic.html" title='mylib::panic fn'>panic</a></td><td class='docblock-short'><p>This function is called on panic, like an assertion failure. We display the filename and line number and pause in the debugger. From https://os.phil-opp.com/freestanding-rust-binary/</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../";window.currentCrate = "mylib";</script><script src="../aliases.js"></script><script src="../main.js"></script><script defer src="../search-index.js"></script></body></html>