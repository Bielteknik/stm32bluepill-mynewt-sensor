<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `listen_sensor` mod in crate `mylib`."><meta name="keywords" content="rust, rustlang, rust-lang, listen_sensor"><title>mylib::listen_sensor - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css"><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script src="../../storage.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="shortcut icon" href="../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../mylib/index.html'><div class='logo-container'><img src='../../rust-logo.png' alt='logo'></div></a><p class='location'>Module listen_sensor</p><div class="sidebar-elems"><div class="block items"><ul><li><a href="#constants">Constants</a></li><li><a href="#functions">Functions</a></li></ul></div><p class='location'><a href='../index.html'>mylib</a></p><script>window.sidebarCurrent = {name: 'listen_sensor', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../settings.html"><img src="../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../src/mylib/listen_sensor.rs.html#1-164' title='goto source code'>[src]</a></span><span class='in-band'>Module <a href='../index.html'>mylib</a>::<wbr><a class="mod" href=''>listen_sensor</a></span></h1><div class='docblock'><p>Poll the temperature sensor every 10 seconds.  We support 2 types of temperature sensors:
(1)  BME280 Temperature Sensor, connected to Blue Pill on port SPI1.
This sensor is selected if BME280_OFB is defined in syscfg.yml.
(2)  Blue Pill internal temperature sensor, connected to port ADC1 on channel 16
This sensor is selected if TEMP_STM32 is defined in syscfg.yml.
If this is the Collector Node, send the sensor data to the CoAP Server after polling.
This is the Rust version of <code>https://github.com/lupyuen/stm32bluepill-mynewt-sensor/blob/rust/apps/my_sensor_app/OLDsrc/listen_sensor.c</code></p>
</div><h2 id='constants' class='section-header'><a href="#constants">Constants</a></h2>
<table><tr class='module-item'><td><a class="constant" href="constant.LISTENER_CB.html" title='mylib::listen_sensor::LISTENER_CB constant'>LISTENER_CB</a></td><td class='docblock-short'><p>Indicate that this is a listener callback</p>
</td></tr><tr class='module-item'><td><a class="constant" href="constant.SENSOR_POLL_TIME.html" title='mylib::listen_sensor::SENSOR_POLL_TIME constant'>SENSOR_POLL_TIME</a></td><td class='docblock-short'><p>Poll every 10,000 milliseconds (10 seconds)  </p>
</td></tr></table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table><tr class='module-item'><td><a class="fn" href="fn.get_temperature.html" title='mylib::listen_sensor::get_temperature fn'>get_temperature</a></td><td class='docblock-short'><p>Get the temperature value, raw or computed.  <code>sensor_data</code> contains the raw or computed temperature. 
<code>sensor_type</code> indicates whether <code>sensor_data</code> contains raw or computed temperature.  We return 
the raw or computed temperature, as well as the key and value type.</p>
</td></tr><tr class='module-item'><td><a class="fn" href="fn.read_temperature.html" title='mylib::listen_sensor::read_temperature fn'>read_temperature</a></td><td class='docblock-short'><p>This listener function is called by Mynewt every 10 seconds (for local sensors) or when sensor data is received
(for Remote Sensors).  Mynewt has fetched the raw or computed temperature value, passed through <code>sensor_data</code>.
If this is a Sensor Node, we send the sensor data to the Collector Node.
If this is a Collector Node or Standalone Node, we send the sensor data to the CoAP server.<br />
Return 0 if we have processed the sensor data successfully.</p>
</td></tr><tr class='module-item'><td><a class="fn" href="fn.start_sensor_listener.html" title='mylib::listen_sensor::start_sensor_listener fn'>start_sensor_listener</a></td><td class='docblock-short'><p>For Sensor Node and Standalone Node: Start polling the temperature sensor 
every 10 seconds in the background.  After polling the sensor, call the 
Listener Function to send the sensor data to the Collector Node (if this is a Sensor Node)
or CoAP Server (is this is a Standalone Node).
For Collector Node: Start the Listeners for Remote Sensor 
Otherwise this is a Standalone Node with ESP8266, or a Sensor Node with nRF24L01.
Return <code>Ok()</code> if successful, else return <code>Err()</code> with <code>MynewtError</code> error code inside.</p>
</td></tr></table></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../../";window.currentCrate = "mylib";</script><script src="../../aliases.js"></script><script src="../../main.js"></script><script defer src="../../search-index.js"></script></body></html>